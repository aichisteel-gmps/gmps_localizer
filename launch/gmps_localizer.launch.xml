<?xml version="1.0" encoding="UTF-8"?>
<launch>
  <!-- switch enables -->
  <arg name="enable_pole" default="true"/> <!--磁気マーカの極性をmarker.csvに設定していない場合はfalse-->
  <arg name="enable_rfid" default="true"/> <!--RFIDを搭載していない場合、タグ番号の書き込みをしていない場合はfalse-->
  <!-- marker.csv -->
  <arg name="marker_table_csv_name" default="/path/to/marker_table.csv"/><!-- 磁気マーカテーブルcsvのフルパス -->
  <!-- TF from base_link to GMPS -->
  <arg name="tf_x" default="1.0"/> <!--baselink to gmps +=front -->
  <arg name="tf_y" default="0.0"/> <!--baselink to gmps +=left -->
  <arg name="tf_yaw" default="0.0"/> <!--baselink to gmps +=CCW -->
  <arg name="tf_rfid_x" default="2.0"/> <!--baselink to rfid +=front -->
  <!-- parameters -->
  <arg name="th_rfid_detect_range_m" default="0.3"/> <!-- RFIDの検知範囲。RFIDとマーカを対応付けする際の許容誤差 -->
  <arg name="th_association_error_dist_m" default="1.0"/> <!-- この距離以内のマーカが見つからなければ対応付けエラー -->
  <arg name="th_association_break_dist_m" default="0.5"/> <!-- この距離以内のマーカが見つかったら探索を打ち切る -->
  <arg name="th_dist_double_marker_m" default="2.5"/> <!--二連マーカと判定する距離閾値-->
  <arg name="th_yaw_diff_double_marker_rad" default="0.05"/> <!--二連マーカと判定するyaw差分閾値-->
  <arg name="marker_d_dist_m" default="2.0"/><!--マーカ間の距離　-->
  <arg name="th_marker_d_dist_m" default="0.2"/><!--マーカ間が正しい閾値 例 マーカ間2.0mで0.2mの場合、2.0±0.2mならマーカ間が正しいと判定-->
  <arg name="th_rfdi_forced_section_change_m" default="100.0"/><!--マーカ検知間の距離が本項目を超えたら、強制的にRFIDによるマーカID補正を行う-->
  <!-- covariance of gmps_pose -->
  <arg name="sigma_x_gmps" default="0.07"/>
  <arg name="sigma_y_gmps" default="0.07"/>
  <arg name="sigma_theta_gmps" default="0.10"/>
  <!-- topic name -->
  <arg name="in_prev_pose_name" default="/prev_pose"/>
  <arg name="in_gmps_detect_name" default="/gmps_detect"/>
  <arg name="in_rfid_name" default="/rfid"/>
  <arg name="in_velocity_name" default="/velocity"/>
  <arg name="out_gmps_pose_name" default="/gmps_pose"/>
  <arg name="out_gmps_log_name" default="/gmps_log"/>

  


  <node pkg="gmps_localizer" exec="gmps_localizer" name="gmps_localizer" output="log">
    <param name="enable_pole" value="$(var enable_pole)"/>
    <param name="enable_rfid" value="$(var enable_rfid)"/>
    <param name="marker_table_csv_name" value="$(var marker_table_csv_name)"/>
    <param name="tf_x" value="$(var tf_x)"/>
    <param name="tf_y" value="$(var tf_y)"/>
    <param name="tf_yaw" value="$(var tf_yaw)"/>
    <param name="tf_rfid_x" value="$(var tf_rfid_x)"/>
    <param name="th_rfid_detect_range_m" value="$(var th_rfid_detect_range_m)"/>
    <param name="th_association_error_dist_m" value="$(var th_association_error_dist_m)"/>
    <param name="th_association_break_dist_m" value="$(var th_association_break_dist_m)"/>
    <param name="th_dist_double_marker_m" value="$(var th_dist_double_marker_m)"/>
    <param name="th_yaw_diff_double_marker_rad" value="$(var th_yaw_diff_double_marker_rad)"/>
    <param name="sigma_x_gmps" value="$(var sigma_x_gmps)"/>
    <param name="sigma_y_gmps" value="$(var sigma_y_gmps)"/>
    <param name="sigma_theta_gmps" value="$(var sigma_theta_gmps)"/>
    <param name="marker_d_dist_m" value="$(var marker_d_dist_m)"/>
    <param name="th_marker_d_dist_m" value="$(var th_marker_d_dist_m)"/>
    <param name="th_rfdi_forced_section_change_m" value="$(var th_rfdi_forced_section_change_m)"/>

    <remap from="in_prev_pose" to="$(var in_prev_pose_name)"/>
    <remap from="in_gmps_detect" to="$(var in_gmps_detect_name)"/>
    <remap from="in_rfid" to="$(var in_rfid_name)"/>
    <remap from="in_velocity" to="$(var in_velocity_name)"/>
    <remap from="out_gmps_pose" to="$(var out_gmps_pose_name)"/>
    <remap from="out_gmps_log" to="$(var out_gmps_log_name)"/>
  </node>

</launch>
